<!-- ViewToggleButton.svelte -->
<script>
  import { tweened } from 'svelte/motion';
  import { linear } from 'svelte/easing';
  
  export let viewMode = 'feed'; // 'feed', 'grid', or 'lightbox'
  export let onClick = () => {};
  
  // Define the three path states - replace these with your actual path data
  const pathStates = {
    feed: "M72 32L63.6172 32.9316M64 32L57.1112 32.984M56 32L50.8496 33.03M48 32L44.8064 33.0644M36 36L40 32M72 24L63.7244 26.7584M64 24L57.2092 26.9104M56 24L50.9296 27.0424M48 24L44.8592 27.1408M40 24L38.9356 27.1936M72 16L63.9268 20.4852M64 16L57.3932 20.7192M56 16L51.0792 20.9208M48 16L44.9576 21.0704M40 16L38.97 21.1504M72 8L64.2044 14.0632M64 8L57.6436 14.3564M56 8L51.2808 14.6068M48 8L45.0896 14.7908M40 8L39.016 14.8888M72 0L64.5336 7.4664M64 0L57.9368 7.7956M56 0L51.5148 8.0732M48 0L45.2416 8.2756M40 0L39.0684 8.3828M0 40L8.3828 39.0684M8 40L14.8888 39.016M16 40L21.1504 38.97M24 40L27.1936 38.9356M36 36L32 40M0 48L8.2756 45.2416M8 48L14.7908 45.0896M16 48L21.0704 44.9576M24 48L27.1408 44.8592M32 48L33.0644 44.8064M0 56L8.0732 51.5148M8 56L14.6068 51.2808M16 56L20.9208 51.0792M24 56L27.0424 50.9296M32 56L33.03 50.8496M0 64L7.7956 57.9368M8 64L14.3564 57.6436M16 64L20.7192 57.3932M24 64L26.9104 57.2092M32 64L32.984 57.1112M0 72L7.4664 64.5336M8 72L14.0632 64.2044M16 72L20.4852 63.9268M24 72L26.7584 63.7244M32 72L32.9316 63.6172M72 40L63.6172 39.0684M64 40L57.1112 39.016M56 40L50.8496 38.97M48 40L44.8064 38.9356M36 36L40 40M72 48L63.7244 45.2416M64 48L57.2092 45.0896M56 48L50.9296 44.9576M48 48L44.8592 44.8592M40 48L38.9356 44.8064M72 56L63.9268 51.5148M64 56L57.3932 51.2808M56 56L51.0792 51.0792M48 56L44.9576 50.9296M40 56L38.97 50.8496M72 64L64.2044 57.9368M64 64L57.6436 57.6436M56 64L51.2808 57.3932M48 64L45.0896 57.2092M40 64L39.016 57.1112M72 72L64.5336 64.5336M64 72L57.9368 64.2044M56 72L51.5148 63.9268M48 72L45.2416 63.7244M40 72L39.0684 63.6172M0 32L8.3828 32.9316M8 32L14.8888 32.984M16 32L21.1504 33.03M24 32L27.1936 33.0644M36 36L32 32M0 24L8.2756 26.7584M8 24L14.7908 26.9104M16 24L21.0704 27.0424M24 24L27.1408 27.1408M32 24L33.0644 27.1936M0 16L8.0732 20.4852M8 16L14.6068 20.7192M16 16L20.9208 20.9208M24 16L27.0424 21.0704M32 16L33.03 21.1504M0 8L7.7956 14.0632M8 8L14.3564 14.3564M16 8L20.7192 14.6068M24 8L26.9104 14.7908M32 8L32.984 14.8888M0 0L7.4664 7.4664M8 0L14.0632 7.7956M16 0L20.4852 8.0732M24 0L26.7584 8.2756M32 0L32.9316 8.3828M36 27L36 30M27 36L30.0197 36M36 45L36 41.9803M45 36L41.9803 36",
    grid: "M72 32L65.8776 25.8776M64 32L60.7632 25.5264M56 32L56 25.3952M48 32L51.2368 25.5264M36 36L46.1224 25.8776M72 24L65.5264 20.7632M64 24L60.5536 20.5536M56 24L56 20.474M48 24L51.4464 20.5536M40 24L46.4736 20.7632M72 16L65.3952 16M64 16L60.474 16M56 16L56 16M48 16L51.526 16M40 16L46.6048 16M72 8L65.5264 11.2368M64 8L60.5536 11.4464M56 8L56 11.526M48 8L51.4464 11.4464M40 8L46.4736 11.2368M72 0L65.8776 6.1224M64 0L60.7632 6.4736M56 0L56 6.6048M48 0L51.2368 6.4736M40 0L46.1224 6.1224M0 40L6.1224 46.1224M8 40L11.2368 46.4736M16 40L16 46.6048M24 40L20.7632 46.4736M36 36L25.8776 46.1224M0 48L6.4736 51.2368M8 48L11.4464 51.4464M16 48L16 51.526M24 48L20.5536 51.4464M32 48L25.5264 51.2368M0 56L6.6048 56M8 56L11.526 56M16 56L16 56M24 56L20.474 56M32 56L25.3952 56M0 64L6.4736 60.7632M8 64L11.4464 60.5536M16 64L16 60.474M24 64L20.5536 60.5536M32 64L25.5264 60.7632M0 72L6.1224 65.8776M8 72L11.2368 65.5264M16 72L16 65.3952M24 72L20.7632 65.5264M32 72L25.8776 65.8776M72 40L65.8776 46.1224M64 40L60.7632 46.4736M56 40L56 46.6048M48 40L51.2368 46.4736M36 36L46.1224 46.1224M72 48L65.5264 51.2368M64 48L60.5536 51.4464M56 48L56 51.526M48 48L51.4464 51.4464M40 48L46.4736 51.2368M72 56L65.3952 56M64 56L60.474 56M56 56L56 56M48 56L51.526 56M40 56L46.6048 56M72 64L65.5264 60.7632M64 64L60.5536 60.5536M56 64L56 60.474M48 64L51.4464 60.5536M40 64L46.4736 60.7632M72 72L65.8776 65.8776M64 72L60.7632 65.5264M56 72L56 65.3952M48 72L51.2368 65.5264M40 72L46.1224 65.8776M0 32L6.1224 25.8776M8 32L11.2368 25.5264M16 32L16 25.3952M24 32L20.7632 25.5264M36 36L25.8776 25.8776M0 24L6.4736 20.7632M8 24L11.4464 20.5536M16 24L16 20.474M24 24L20.5536 20.5536M32 24L25.5264 20.7632M0 16L6.6048 16M8 16L11.526 16M16 16L16 16M24 16L20.474 16M32 16L25.3952 16M0 8L6.4736 11.2368M8 8L11.4464 11.4464M16 8L16 11.526M24 8L20.5536 11.4464M32 8L25.5264 11.2368M0 0L6.1224 6.1224M8 0L11.2368 6.4736M16 0L16 6.6048M24 0L20.7632 6.4736M32 0L25.8776 6.1224M36 30L36 0M30 36L0 36M36 42L36 72M42 36L72 36",
    lightbox: "M72 32L72 32M64 32L64 32M56 32L56 32M48 32L48 32M36 36L72 0M72 24L72 24M64 24L64 24M56 24L56 24M48 24L48 24M40 24L40 24M72 16L72 16M64 16L64 16M56 16L56 16M48 16L48 16M40 16L40 16M72 8L72 8M64 8L64 8M56 8L56 8M48 8L48 8M40 8L40 8M72 0L72 0M64 0L64 0M56 0L56 0M48 0L48 0M40 0L40 0M0 40L0 40M8 40L8 40M16 40L16 40M24 40L24 40M36 36L0 72M0 48L0 48M8 48L8 48M16 48L16 48M24 48L24 48M32 48L32 48M0 56L0 56M8 56L8 56M16 56L16 56M24 56L24 56M32 56L32 56M0 64L0 64M8 64L8 64M16 64L16 64M24 64L24 64M32 64L32 64M0 72L0 72M8 72L8 72M16 72L16 72M24 72L24 72M32 72L32 72M72 40L72 40M64 40L64 40M56 40L56 40M48 40L48 40M36 36L72 72M72 48L72 48M64 48L64 48M56 48L56 48M48 48L48 48M40 48L40 48M72 56L72 56M64 56L64 56M56 56L56 56M48 56L48 56M40 56L40 56M72 64L72 64M64 64L64 64M56 64L56 64M48 64L48 64M40 64L40 64M72 72L72 72M64 72L64 72M56 72L56 72M48 72L48 72M40 72L40 72M0 32L0 32M8 32L8 32M16 32L16 32M24 32L24 32M36 36L0 0M0 24L0 24M8 24L8 24M16 24L16 24M24 24L24 24M32 24L32 24M0 16L0 16M8 16L8 16M16 16L16 16M24 16L24 16M32 16L32 16M0 8L0 8M8 8L8 8M16 8L16 8M24 8L24 8M32 8L32 8M0 0L0 0M8 0L8 0M16 0L16 0M24 0L24 0M32 0L32 0M36 36L36 36M36 36L36 36M36 36L36 36M36 36L36 36"
  };
  
  // Extract numbers from SVG path string
  function extractNumbers(path) {
    return path.match(/[-+]?[0-9]*\.?[0-9]+/g)?.map(Number) || [];
  }
  
  // Reconstruct path from numbers and original path template
  function reconstructPath(numbers, template) {
    let numIndex = 0;
    return template.replace(/[-+]?[0-9]*\.?[0-9]+/g, () => {
      return numbers[numIndex++]?.toFixed(2) || '0';
    });
  }
  
  // Extract coordinates from current path
  $: currentNumbers = extractNumbers(pathStates[viewMode] || pathStates.feed);
  
  // Create tweened store for coordinate interpolation
  const coordinatesTween = tweened(currentNumbers, {
    duration: 200,
    easing: linear
  });
  
  // Update tweened store when viewMode changes
  $: coordinatesTween.set(currentNumbers);
  
  // Reconstruct path from tweened coordinates
  $: tweenedPath = reconstructPath($coordinatesTween, pathStates[viewMode] || pathStates.feed);
</script>

<div 
  class="view-toggle-btn" 
  on:click={onClick} 
  role="button" 
  tabindex="0"
  on:keydown={(e) => {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      onClick();
    }
  }}
>
  <svg 
    width="72" 
    height="72" 
    viewBox="0 0 72 72" 
    fill="none" 
    xmlns="http://www.w3.org/2000/svg"
  >
    <path 
      d={tweenedPath}
      fill="none"
      stroke="currentColor"
      stroke-width="1"
    />
  </svg>
</div>

<style>
  .view-toggle-btn {
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    outline: none;
    transition: color 0.2s ease;
  }
  
  .view-toggle-btn:hover {
    color: var(--highlight-color, #007bff);
  }
  
  .view-toggle-btn:focus-visible {
    outline: 2px solid var(--highlight-color, #007bff);
    outline-offset: 2px;
    border-radius: 4px;
  }
  
  svg {
    display: block;
  }
</style> 