<!-- ViewToggleButton.svelte -->
<script>
  import { tweened } from 'svelte/motion';
  import { linear } from 'svelte/easing';
  
  export let viewMode = 'feed'; // 'feed', 'grid', or 'lightbox'
  export let onClick = () => {};
  
  // Define the three path states - replace these with your actual path data
  const pathStates = {
feed: "M1.4 70.94C2.0633 70.2767 2.7267 69.6133 3.39 68.95M9.89 71.21C10.59 70.2767 11.29 69.3433 11.99 68.41M18.54 71.42C19.11 70.2767 19.68 69.1333 20.25 67.99M27.32 71.55C27.64 70.2767 27.96 69.0033 28.28 67.73M36.17 71.6C36.17 70.28 36.17 68.96 36.17 67.64M45.02 71.55C44.7 70.2767 44.38 69.0033 44.06 67.73M53.8 71.42C53.23 70.2767 52.66 69.1333 52.09 67.99M62.45 71.21C61.75 70.2767 61.05 69.3433 60.35 68.41M70.94 70.94C70.2767 70.2767 69.6133 69.6133 68.95 68.95M1.13 62.45C2.0633 61.75 2.9967 61.05 3.93 60.35M9.67 62.67C10.5933 61.7467 11.5167 60.8233 12.44 59.9M18.39 62.85C19.12 61.7567 19.85 60.6633 20.58 59.57M27.24 62.96C27.64 61.7567 28.04 60.5533 28.44 59.35M36.17 62.99C36.17 61.75 36.17 60.51 36.17 59.27M45.1 62.96C44.7 61.7567 44.3 60.5533 43.9 59.35M53.95 62.85C53.22 61.7567 52.49 60.6633 51.76 59.57M62.67 62.67C61.7467 61.7467 60.8233 60.8233 59.9 59.9M71.21 62.45C70.2767 61.75 69.3433 61.05 68.41 60.35M0.92 53.8C2.0633 53.23 3.2067 52.66 4.35 52.09M9.49 53.95C10.5833 53.22 11.6767 52.49 12.77 51.76M0.38 71.96C7.1933 65.1467 14.0067 58.3333 20.82 51.52M18.2 72.12C21.66 65.2033 25.12 58.2867 28.58 51.37M36.17 72.17C36.17 65.2167 36.17 58.2633 36.17 51.31M54.14 72.12C50.68 65.2033 47.22 58.2867 43.76 51.37M71.96 71.96C65.1467 65.1467 58.3333 58.3333 51.52 51.52M62.85 53.95C61.7567 53.22 60.6633 52.49 59.57 51.76M71.42 53.8C70.2767 53.23 69.1333 52.66 67.99 52.09M0.79 45.02C2.0633 44.7 3.3367 44.38 4.61 44.06M9.38 45.1C10.5833 44.7 11.7867 44.3 12.99 43.9M0.22 54.14C7.1367 50.68 14.0533 47.22 20.97 43.76M18.12 54.22C21.6333 50.7067 25.1467 47.1933 28.66 43.68M36.17 54.25C36.17 50.7167 36.17 47.1833 36.17 43.65M54.22 54.22C50.7067 50.7067 47.1933 47.1933 43.68 43.68M72.12 54.14C65.2033 50.68 58.2867 47.22 51.37 43.76M62.96 45.1C61.7567 44.7 60.5533 44.3 59.35 43.9M71.55 45.02C70.2767 44.7 69.0033 44.38 67.73 44.06M0.74 36.17C2.06 36.17 3.38 36.17 4.7 36.17M9.35 36.17C10.59 36.17 11.83 36.17 13.07 36.17M0.17 36.17C7.1233 36.17 14.0767 36.17 21.03 36.17M18.09 36.17C21.6233 36.17 25.1567 36.17 28.69 36.17M36.17 36.17C36.17 36.17 36.17 36.17 36.17 36.17M54.25 36.17C50.7167 36.17 47.1833 36.17 43.65 36.17M72.17 36.17C65.2167 36.17 58.2633 36.17 51.31 36.17M62.99 36.17C61.75 36.17 60.51 36.17 59.27 36.17M71.6 36.17C70.28 36.17 68.96 36.17 67.64 36.17M0.79 27.32C2.0633 27.64 3.3367 27.96 4.61 28.28M9.38 27.24C10.5833 27.64 11.7867 28.04 12.99 28.44M0.22 18.2C7.1367 21.66 14.0533 25.12 20.97 28.58M18.12 18.12C21.6333 21.6333 25.1467 25.1467 28.66 28.66M36.17 18.09C36.17 21.6233 36.17 25.1567 36.17 28.69M54.22 18.12C50.7067 21.6333 47.1933 25.1467 43.68 28.66M72.12 18.2C65.2033 21.66 58.2867 25.12 51.37 28.58M62.96 27.24C61.7567 27.64 60.5533 28.04 59.35 28.44M71.55 27.32C70.2767 27.64 69.0033 27.96 67.73 28.28M0.92 18.54C2.0633 19.11 3.2067 19.68 4.35 20.25M9.49 18.39C10.5833 19.12 11.6767 19.85 12.77 20.58M0.38 0.38C7.1933 7.1933 14.0067 14.0067 20.82 20.82M18.2 0.22C21.66 7.1367 25.12 14.0533 28.58 20.97M36.17 0.17C36.17 7.1233 36.17 14.0767 36.17 21.03M54.14 0.22C50.68 7.1367 47.22 14.0533 43.76 20.97M71.96 0.38C65.1467 7.1933 58.3333 14.0067 51.52 20.82M62.85 18.39C61.7567 19.12 60.6633 19.85 59.57 20.58M71.42 18.54C70.2767 19.11 69.1333 19.68 67.99 20.25M1.13 9.89C2.0633 10.59 2.9967 11.29 3.93 11.99M9.67 9.67C10.5933 10.5933 11.5167 11.5167 12.44 12.44M18.39 9.49C19.12 10.5833 19.85 11.6767 20.58 12.77M27.24 9.38C27.64 10.5833 28.04 11.7867 28.44 12.99M36.17 9.35C36.17 10.59 36.17 11.83 36.17 13.07M45.1 9.38C44.7 10.5833 44.3 11.7867 43.9 12.99M53.95 9.49C53.22 10.5833 52.49 11.6767 51.76 12.77M62.67 9.67C61.7467 10.5933 60.8233 11.5167 59.9 12.44M71.21 9.89C70.2767 10.59 69.3433 11.29 68.41 11.99M1.4 1.4C2.0633 2.0633 2.7267 2.7267 3.39 3.39M9.89 1.13C10.59 2.0633 11.29 2.9967 11.99 3.93M18.54 0.92C19.11 2.0633 19.68 3.2067 20.25 4.35M27.32 0.79C27.64 2.0633 27.96 3.3367 28.28 4.61M36.17 0.74C36.17 2.06 36.17 3.38 36.17 4.7M45.02 0.79C44.7 2.0633 44.38 3.3367 44.06 4.61M53.8 0.92C53.23 2.0633 52.66 3.2067 52.09 4.35M62.45 1.13C61.75 2.0633 61.05 2.9967 60.35 3.93M70.94 1.4C70.2767 2.0633 69.6133 2.7267 68.95 3.39",
    grid: "M1.4 70.94C7.5233 64.8167 13.6467 58.6933 19.77 52.57M9.89 71.21C14.6167 64.9067 19.3433 58.6033 24.07 52.3M18.54 71.42C21.76 64.9767 24.98 58.5333 28.2 52.09M27.32 71.55C28.9533 65.02 30.5867 58.49 32.22 51.96M36.17 71.6C36.17 65.04 36.17 58.48 36.17 51.92M45.02 71.55C43.3867 65.02 41.7533 58.49 40.12 51.96M53.8 71.42C50.58 64.9767 47.36 58.5333 44.14 52.09M62.45 71.21C57.7233 64.9067 52.9967 58.6033 48.27 52.3M70.94 70.94C64.8167 64.8167 58.6933 58.6933 52.57 52.57M1.13 62.45C7.4333 57.7233 13.7367 52.9967 20.04 48.27M9.67 62.67C14.5467 57.7933 19.4233 52.9167 24.3 48.04M18.39 62.85C21.7167 57.86 25.0433 52.87 28.37 47.88M27.24 62.96C28.9267 57.8967 30.6133 52.8333 32.3 47.77M36.17 62.99C36.17 57.9033 36.17 52.8167 36.17 47.73M45.1 62.96C43.4133 57.8967 41.7267 52.8333 40.04 47.77M53.95 62.85C50.6233 57.86 47.2967 52.87 43.97 47.88M62.67 62.67C57.7933 57.7933 52.9167 52.9167 48.04 48.04M71.21 62.45C64.9067 57.7233 58.6033 52.9967 52.3 48.27M0.92 53.8C7.3633 50.58 13.8067 47.36 20.25 44.14M9.49 53.95C14.48 50.6233 19.47 47.2967 24.46 43.97M18.26 54.08C21.67 50.67 25.08 47.26 28.49 43.85M27.18 54.16C28.91 50.7 30.64 47.24 32.37 43.78M36.17 54.18C36.17 50.7 36.17 47.22 36.17 43.74M45.16 54.16C43.43 50.7 41.7 47.24 39.97 43.78M54.08 54.08C50.67 50.67 47.26 47.26 43.85 43.85M62.85 53.95C57.86 50.6233 52.87 47.2967 47.88 43.97M71.42 53.8C64.9767 50.58 58.5333 47.36 52.09 44.14M0.79 45.02C7.32 43.3867 13.85 41.7533 20.38 40.12M9.38 45.1C14.4433 43.4133 19.5067 41.7267 24.57 40.04M18.18 45.16C21.64 43.43 25.1 41.7 28.56 39.97M27.14 45.2C28.8967 43.4433 30.6533 41.6867 32.41 39.93M36.17 45.22C36.17 43.4533 36.17 41.6867 36.17 39.92M45.2 45.2C43.4433 43.4433 41.6867 41.6867 39.93 39.93M54.16 45.16C50.7 43.43 47.24 41.7 43.78 39.97M62.96 45.1C57.8967 43.4133 52.8333 41.7267 47.77 40.04M71.55 45.02C65.02 43.3867 58.49 41.7533 51.96 40.12M0.74 36.17C7.3 36.17 13.86 36.17 20.42 36.17M9.35 36.17C14.4367 36.17 19.5233 36.17 24.61 36.17M18.16 36.17C21.64 36.17 25.12 36.17 28.6 36.17M27.12 36.17C28.8867 36.17 30.6533 36.17 32.42 36.17M36.17 36.17C36.17 36.17 36.17 36.17 36.17 36.17M45.22 36.17C43.4533 36.17 41.6867 36.17 39.92 36.17M54.18 36.17C50.7 36.17 47.22 36.17 43.74 36.17M62.99 36.17C57.9033 36.17 52.8167 36.17 47.73 36.17M71.6 36.17C65.04 36.17 58.48 36.17 51.92 36.17M0.79 27.32C7.32 28.9533 13.85 30.5867 20.38 32.22M9.38 27.24C14.4433 28.9267 19.5067 30.6133 24.57 32.3M18.18 27.18C21.64 28.91 25.1 30.64 28.56 32.37M27.14 27.14C28.8967 28.8967 30.6533 30.6533 32.41 32.41M36.17 27.12C36.17 28.8867 36.17 30.6533 36.17 32.42M45.2 27.14C43.4433 28.8967 41.6867 30.6533 39.93 32.41M54.16 27.18C50.7 28.91 47.24 30.64 43.78 32.37M62.96 27.24C57.8967 28.9267 52.8333 30.6133 47.77 32.3M71.55 27.32C65.02 28.9533 58.49 30.5867 51.96 32.22M0.92 18.54C7.3633 21.76 13.8067 24.98 20.25 28.2M9.49 18.39C14.48 21.7167 19.47 25.0433 24.46 28.37M18.26 18.26C21.67 21.67 25.08 25.08 28.49 28.49M27.18 18.18C28.91 21.64 30.64 25.1 32.37 28.56M36.17 18.16C36.17 21.64 36.17 25.12 36.17 28.6M45.16 18.18C43.43 21.64 41.7 25.1 39.97 28.56M54.08 18.26C50.67 21.67 47.26 25.08 43.85 28.49M62.85 18.39C57.86 21.7167 52.87 25.0433 47.88 28.37M71.42 18.54C64.9767 21.76 58.5333 24.98 52.09 28.2M1.13 9.89C7.4333 14.6167 13.7367 19.3433 20.04 24.07M9.67 9.67C14.5467 14.5467 19.4233 19.4233 24.3 24.3M18.39 9.49C21.7167 14.48 25.0433 19.47 28.37 24.46M27.24 9.38C28.9267 14.4433 30.6133 19.5067 32.3 24.57M36.17 9.35C36.17 14.4367 36.17 19.5233 36.17 24.61M45.1 9.38C43.4133 14.4433 41.7267 19.5067 40.04 24.57M53.95 9.49C50.6233 14.48 47.2967 19.47 43.97 24.46M62.67 9.67C57.7933 14.5467 52.9167 19.4233 48.04 24.3M71.21 9.89C64.9067 14.6167 58.6033 19.3433 52.3 24.07M1.4 1.4C7.5233 7.5233 13.6467 13.6467 19.77 19.77M9.89 1.13C14.6167 7.4333 19.3433 13.7367 24.07 20.04M18.54 0.92C21.76 7.3633 24.98 13.8067 28.2 20.25M27.32 0.79C28.9533 7.32 30.5867 13.85 32.22 20.38M36.17 0.74C36.17 7.3 36.17 13.86 36.17 20.42M45.02 0.79C43.3867 7.32 41.7533 13.85 40.12 20.38M53.8 0.92C50.58 7.3633 47.36 13.8067 44.14 20.25M62.45 1.13C57.7233 7.4333 52.9967 13.7367 48.27 20.04M70.94 1.4C64.8167 7.5233 58.6933 13.6467 52.57 19.77",
    lightbox: "M7.25 69.59C5.75 68.09 4.25 66.59 2.75 65.09M15.34 69.25C13.6433 67.9767 11.9467 66.7033 10.25 65.43M23.43 68.76C21.5333 67.8133 19.6367 66.8667 17.74 65.92M31.46 68.11C29.4033 67.5967 27.3467 67.0833 25.29 66.57M39.35 67.34C37.23 67.34 35.11 67.34 32.99 67.34M47.05 66.57C44.9933 67.0833 42.9367 67.5967 40.88 68.11M54.6 65.92C52.7033 66.8667 50.8067 67.8133 48.91 68.76M62.09 65.43C60.3933 66.7033 58.6967 67.9767 57 69.25M69.59 65.09C68.09 66.59 66.59 68.09 65.09 69.59M6.91 62.09C5.6367 60.3933 4.3633 58.6967 3.09 57M15.04 61.8C13.54 60.3 12.04 58.8 10.54 57.3M23.23 61.31C21.4667 60.1333 19.7033 58.9567 17.94 57.78M31.39 60.55C29.38 59.88 27.37 59.21 25.36 58.54M39.35 59.55C37.23 59.55 35.11 59.55 32.99 59.55M46.98 58.54C44.97 59.21 42.96 59.88 40.95 60.55M54.4 57.78C52.6367 58.9567 50.8733 60.1333 49.11 61.31M61.8 57.3C60.3 58.8 58.8 60.3 57.3 61.8M69.25 57C67.9767 58.6967 66.7033 60.3933 65.43 62.09M6.42 54.6C5.4733 52.7033 4.5267 50.8067 3.58 48.91M14.56 54.4C13.3833 52.6367 12.2067 50.8733 11.03 49.11M22.83 54C21.33 52.5 19.83 51 18.33 49.5M31.22 53.18C29.3233 52.2333 27.4267 51.2867 25.53 50.34M39.35 51.75C37.23 51.75 35.11 51.75 32.99 51.75M46.81 50.33C44.9133 51.2767 43.0167 52.2233 41.12 53.17M54 49.51C52.5 51.01 51 52.51 49.5 54.01M61.31 49.11C60.1333 50.8733 58.9567 52.6367 57.78 54.4M68.76 48.91C67.8133 50.8067 66.8667 52.7033 65.92 54.6M5.77 47.05C5.2567 44.9933 4.7433 42.9367 4.23 40.88M13.8 46.98C13.13 44.97 12.46 42.96 11.79 40.95M22.01 46.81C21.0633 44.9133 20.1167 43.0167 19.17 41.12M30.63 46.21C29.13 44.71 27.63 43.21 26.13 41.71M39.35 43.96C37.23 43.96 35.11 43.96 32.99 43.96M46.21 41.71C44.71 43.21 43.21 44.71 41.71 46.21M53.18 41.12C52.2333 43.0167 51.2867 44.9133 50.34 46.81M60.55 40.95C59.88 42.96 59.21 44.97 58.54 46.98M68.11 40.88C67.5967 42.9367 67.0833 44.9933 66.57 47.05M5 39.35C5 37.23 5 35.11 5 32.99M12.79 39.35C12.79 37.23 12.79 35.11 12.79 32.99M20.58 39.35C20.58 37.23 20.58 35.11 20.58 32.99M28.38 39.35C28.38 37.23 28.38 35.11 28.38 32.99M36.17 39.35C36.17 37.23 36.17 35.11 36.17 32.99M43.96 32.99C43.96 35.11 43.96 37.23 43.96 39.35M51.75 32.99C51.75 35.11 51.75 37.23 51.75 39.35M59.55 32.99C59.55 35.11 59.55 37.23 59.55 39.35M67.34 32.99C67.34 35.11 67.34 37.23 67.34 39.35M4.23 31.46C4.7433 29.4033 5.2567 27.3467 5.77 25.29M11.79 31.39C12.46 29.38 13.13 27.37 13.8 25.36M19.16 31.22C20.1067 29.3233 21.0533 27.4267 22 25.53M26.13 30.63C27.63 29.13 29.13 27.63 30.63 26.13M32.99 28.38C35.11 28.38 37.23 28.38 39.35 28.38M41.71 26.13C43.21 27.63 44.71 29.13 46.21 30.63M50.33 25.53C51.2767 27.4267 52.2233 29.3233 53.17 31.22M58.54 25.36C59.21 27.37 59.88 29.38 60.55 31.39M66.57 25.29C67.0833 27.3467 67.5967 29.4033 68.11 31.46M3.58 23.43C4.5267 21.5333 5.4733 19.6367 6.42 17.74M11.03 23.23C12.2067 21.4667 13.3833 19.7033 14.56 17.94M18.34 22.83C19.84 21.33 21.34 19.83 22.84 18.33M25.53 22.01C27.4267 21.0633 29.3233 20.1167 31.22 19.17M32.99 20.58C35.11 20.58 37.23 20.58 39.35 20.58M41.12 19.16C43.0167 20.1067 44.9133 21.0533 46.81 22M49.51 18.34C51.01 19.84 52.51 21.34 54.01 22.84M57.78 17.94C58.9567 19.7033 60.1333 21.4667 61.31 23.23M65.92 17.74C66.8667 19.6367 67.8133 21.5333 68.76 23.43M3.09 15.34C4.3633 13.6433 5.6367 11.9467 6.91 10.25M10.54 15.04C12.04 13.54 13.54 12.04 15.04 10.54M17.94 14.56C19.7033 13.3833 21.4667 12.2067 23.23 11.03M25.36 13.8C27.37 13.13 29.38 12.46 31.39 11.79M32.99 12.79C35.11 12.79 37.23 12.79 39.35 12.79M40.95 11.79C42.96 12.46 44.97 13.13 46.98 13.8M49.11 11.03C50.8733 12.2067 52.6367 13.3833 54.4 14.56M57.3 10.54C58.8 12.04 60.3 13.54 61.8 15.04M65.43 10.25C66.7033 11.9467 67.9767 13.6433 69.25 15.34M2.75 7.25C4.25 5.75 5.75 4.25 7.25 2.75M10.25 6.91C11.9467 5.6367 13.6433 4.3633 15.34 3.09M17.74 6.42C19.6367 5.4733 21.5333 4.5267 23.43 3.58M25.29 5.77C27.3467 5.2567 29.4033 4.7433 31.46 4.23M32.99 5C35.11 5 37.23 5 39.35 5M40.88 4.23C42.9367 4.7433 44.9933 5.2567 47.05 5.77M48.91 3.58C50.8067 4.5267 52.7033 5.4733 54.6 6.42M57 3.09C58.6967 4.3633 60.3933 5.6367 62.09 6.91M65.09 2.75C66.59 4.25 68.09 5.75 69.59 7.25"
  };
  
  // Extract numbers from SVG path string
  function extractNumbers(path) {
    return path.match(/[-+]?[0-9]*\.?[0-9]+/g)?.map(Number) || [];
  }
  
  // Reconstruct path from numbers and original path template
  function reconstructPath(numbers, template) {
    let numIndex = 0;
    return template.replace(/[-+]?[0-9]*\.?[0-9]+/g, () => {
      return numbers[numIndex++]?.toFixed(2) || '0';
    });
  }
  
  // Extract coordinates from current path
  $: currentNumbers = extractNumbers(pathStates[viewMode] || pathStates.feed);
  
  // Create tweened store for coordinate interpolation
  const coordinatesTween = tweened(currentNumbers, {
    duration: 200,
    easing: linear
  });
  
  // Update tweened store when viewMode changes
  $: coordinatesTween.set(currentNumbers);
  
  // Reconstruct path from tweened coordinates
  $: tweenedPath = reconstructPath($coordinatesTween, pathStates[viewMode] || pathStates.feed);
</script>

<div 
  class="view-toggle-btn" 
  on:click={onClick} 
  role="button" 
  tabindex="0"
  on:keydown={(e) => {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      onClick();
    }
  }}
>
  <svg 
    width="72" 
    height="72" 
    viewBox="0 0 72 72" 
    fill="none" 
    xmlns="http://www.w3.org/2000/svg"
  >
    <path 
      d={tweenedPath}
      fill="none"
      stroke="currentColor"
      stroke-width="2"
    />
  </svg>
</div>

<style>
  .view-toggle-btn {
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    outline: none;
    transition: color 0.2s ease;
  }
  
  .view-toggle-btn:hover {
    color: var(--highlight-color, #007bff);
  }
  
  .view-toggle-btn:focus-visible {
    outline: 2px solid var(--highlight-color, #007bff);
    outline-offset: 2px;
    border-radius: 4px;
  }
  
  svg {
    display: block;
  }
</style> 